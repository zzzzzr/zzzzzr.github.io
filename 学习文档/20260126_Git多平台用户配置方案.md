# [AI] Git 多平台（GitHub/GitLab）用户配置方案

## 问题描述

同时使用 GitHub 和 GitLab 时，由于 Git 全局配置只能设置一个用户名和邮箱，在不同平台之间切换时会导致提交记录的作者信息错乱。

例如：
- GitHub 使用个人邮箱 `personalEmail@qq.com`
- GitLab 使用公司邮箱 `companyEmail@companyName.tech`

如果全局配置使用 GitHub 邮箱，那么向 GitLab 提交代码时，作者信息就会显示为 GitHub 的邮箱，造成混乱。



## 解决方案：Git 条件配置（Conditional Includes）

Git 2.13+ 支持根据目录路径自动切换配置。通过 `includeIf` 指令，可以让不同目录下的仓库使用不同的用户配置。



### 配置步骤

#### 1. 规划目录结构

将不同平台的项目放在不同的目录下：

```
~/Documents/
├── for_hub/      # GitHub 项目
│   ├── personalProject1/
│   ├── personalProject2/
│   └── companyProject1Copy/       # 特殊：虽在 for_hub 下，但使用 GitLab 配置
└── for_git/      # GitLab 项目
    ├── companyProject1/
    ├── companyProject2/
    └── other-company-projects/
```



#### 2. 创建专用配置文件

**GitLab 配置文件 `~/.gitconfig-forgit`：**

```ini
[user]
	name = realName
	email = companyEmail@companyName.tech
```

**GitHub 配置文件 `~/.gitconfig-forhub`：**

```ini
[user]
	name = personalName
	email = personalEmail@qq.com
```



#### 3. 修改全局配置 `~/.gitconfig`

在全局配置文件末尾添加条件配置：

```ini
[user]
	name = personalName
	email = personalEmail@qq.com

# ... 其他配置 ...

[includeIf "gitdir:~/Documents/for_git/"]
	path = ~/.gitconfig-forgit

[includeIf "gitdir:~/Documents/for_hub/"]
	path = ~/.gitconfig-forhub

[includeIf "gitdir:~/Documents/for_hub/companyProject1Copy/"]
	path = ~/.gitconfig-forgit
```



### 配置说明

| 配置项 | 说明 |
|--------|------|
| `gitdir:~/Documents/for_git/` | 匹配该目录下的所有 Git 仓库 |
| `path = ~/.gitconfig-forgit` | 使用指定的配置文件 |

**注意事项：**

- 路径末尾的 `/` 很重要，表示匹配该目录及其子目录
- 条件配置按顺序处理，后面的会覆盖前面的
- 更具体的路径应该放在后面（如 `for_hub/companyProject1Copy/` 放在 `for_hub/` 后面）



### 最终配置效果

| 目录 | 用户名 | 邮箱 |
|------|--------|------|
| `~/Documents/for_git/*` | realName | companyEmail@companyName.tech |
| `~/Documents/for_hub/*` | personalName | personalEmail@qq.com |
| `~/Documents/for_hub/companyProject1Copy/` | realName | companyEmail@companyName.tech |
| 其他目录 | personalName | personalEmail@qq.com |



### 验证配置

在任意仓库目录下运行以下命令验证当前生效的配置：

```bash
git config user.name
git config user.email
```

或查看完整配置来源：

```bash
git config --show-origin user.email
```



## 其他解决方案

### 方案二：为每个仓库单独设置

如果不想按目录划分，也可以为每个仓库单独设置：

```bash
cd /path/to/your/repo
git config --local user.name "用户名"
git config --local user.email "邮箱"
```

`--local` 配置只对当前仓库生效，优先级高于全局配置。

**优点：** 灵活，不受目录结构限制
**缺点：** 每个新仓库都需要手动配置，容易遗漏



## 参考资料

- [Git 官方文档 - Conditional Includes](https://git-scm.com/docs/git-config#_conditional_includes)
- Git 版本要求：2.13+



---

*文档创建日期：2026-01-26*
